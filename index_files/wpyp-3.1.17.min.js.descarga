function consultaDataPayment(e){var t={async:!0,crossDomain:!0,url:opcionesPagoUrl,method:"POST",dataType:"json",processData:!1,contentType:"application/json",data:'{"cnum":"'+e+'","iRef":"'+idUrl+'","nEventId":"'+nEventId+'"}'};$.ajax(t).done(function(e){if($("#divDCC").addClass("hide"),$("#meses").addClass("hide"),$('[data-fv-for="merchant"]').css("display","none"),"true"===e.success){if(isValidTdc=!0,"1"===e.stDcc){$(".nb_currency").text(e.infoDcc.nb_currency),$(".hex_symbol").html("&#"+e.infoDcc.hex_symbol),$(".nb_curr_code").text(e.infoDcc.nb_curr_code),$(".markup").text(e.infoDcc.markup),$(".rate").text(e.infoDcc.rate),$(".dcc_amount").text(e.infoDcc.dcc_amount),$("#divDCC").removeClass("hide"),$("#meses").addClass("hide");var t={Contado:"C"};t=$("<option></option>").attr("value","C").text("Contado");$("#merchant").empty().append(t)}else{$("#divDCC").addClass("hide"),$("#btnPagoSin").removeClass("hidden"),$("#btnPagoCon").addClass("hidden");var a=!0;for($("#merchant").empty(),e.merchants.length>1&&$("#merchant").append('<option value="0" >Selecciona una opcion de pago</option>'),i=0;i<e.merchants.length;i++)$("#merchant").append('<option value="'+e.merchants[i].id+'" >'+e.merchants[i].name+"</option>"),a=a&&"C"==e.merchants[i].id;if(a){$("#meses").addClass("hide"),$("#merchant").val("C")}else $("#meses").removeClass("hide")}void 0!==e.vigTCC&&($("#vigTCC").val(e.vigTCC),"0"==$("#vigTCC").val()&&$("#frmWpyPayment").bootstrapValidator("revalidateField",$("#cardnum")));try{fields_3ds="true"==e.fields_3ds,fields_3ds&&(document.getElementById("groupTH").style.display="none",document.getElementById("telgroup").style.display="none"),fields_3ds||"2"!=e.v_3ds||(document.getElementById("groupTH").style.display="inline",document.getElementById("telgroup").style.display="grid")}catch(e){}}else{$("#divDCC").addClass("hide"),$("#btnPagoSin").removeClass("hidden"),$("#btnPagoCon").addClass("hidden"),$("#meses").addClass("hide");t={Contado:"C"},t=$("<option></option>").attr("value","C").text("Contado");$("#merchant").empty().append(t),isValidTdc=!1}vTdcPrevSubmit&&$("#frmWpyPayment").bootstrapValidator("revalidateField",$("#cardnum"))})}function showAmex(){$("#stSKey").removeClass("hidden"),$("#stSKeyMail").removeClass("hidden"),$("#txtSKey").removeClass("hidden"),$("#st3ds").addClass("hidden")}function hideAmex(){null==$('div[data-version3ds="2"]').attr("id")&&$("#stSKey").addClass("hidden"),stCorreo||$("#stSKeyMail").addClass("hidden"),$("#txtSKey").addClass("hidden"),$("#st3ds").removeClass("hidden"),$('input[data-wpy="tel"]').val("")}(function(){var e,t,a,n,r,s,o,i,d,l,c,p,u,m,h,v,f,y,g,$,C,w,b,T,x=[].slice,S=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1};(e=window.jQuery||window.Zepto||window.$).payment={},e.payment.fn={},e.fn.payment=function(){var t,a;return a=arguments[0],t=2<=arguments.length?x.call(arguments,1):[],e.payment.fn[a].apply(this,t)},r=/(\d{1,4})/g,e.payment.cards=n=[{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:r,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:r,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:r,length:[16],cvcLength:[3],luhn:!0},{type:"visa",patterns:[4],format:r,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:r,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:r,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:r,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:r,length:[16],cvcLength:[3],luhn:!0}],t=function(e){var t,a,r,s,o,i,d;for(e=(e+"").replace(/\D/g,""),r=0,o=n.length;r<o;r++)for(s=0,i=(d=(t=n[r]).patterns).length;s<i;s++)if(a=d[s]+"",e.substr(0,a.length)===a)return t},a=function(e){var t,a,r;for(a=0,r=n.length;a<r;a++)if((t=n[a]).type===e)return t},u=function(e){var t,a,n,r,s,o;for(n=!0,r=0,s=0,o=(a=(e+"").split("").reverse()).length;s<o;s++)t=a[s],t=parseInt(t,10),(n=!n)&&(t*=2),t>9&&(t-=9),r+=t;return r%10==0},p=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},b=function(e,t){var a,n,r,s,o;try{n=t.prop("selectionStart")}catch(e){e,n=null}if(s=t.val(),t.val(e),null!==n&&t.is(":focus"))return n===s.length&&(n=e.length),s!==e&&(o=s.slice(n-1,+n+1||9e9),a=e.slice(n-1,+n+1||9e9),r=e[n],/\d/.test(r)&&o===r+" "&&a===" "+r&&(n+=1)),t.prop("selectionStart",n),t.prop("selectionEnd",n)},y=function(e){var t,a,n,r,s,o;for(null==e&&(e=""),"０１２３４５６７８９","0123456789",r="",s=0,o=(t=e.split("")).length;s<o;s++)a=t[s],(n="０１２３４５６７８９".indexOf(a))>-1&&(a="0123456789"[n]),r+=a;return r},f=function(t){var a;return a=e(t.currentTarget),setTimeout(function(){var e;return e=a.val(),e=(e=y(e)).replace(/\D/g,""),b(e,a)})},h=function(t){var a;return a=e(t.currentTarget),setTimeout(function(){var t;return t=a.val(),t=y(t),t=e.payment.formatCardNumber(t),b(t,a)})},i=function(a){var n,r,s,o,i,d,l;if(s=String.fromCharCode(a.which),/^\d+$/.test(s)&&(n=e(a.currentTarget),l=n.val(),r=t(l+s),o=(l.replace(/\D/g,"")+s).length,d=16,r&&(d=r.length[r.length.length-1]),!(o>=d||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==l.length)))return(i=r&&"amex"===r.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/).test(l)?(a.preventDefault(),setTimeout(function(){return n.val(l+" "+s)})):i.test(l+s)?(a.preventDefault(),setTimeout(function(){return n.val(l+s+" ")})):void 0},s=function(t){var a,n;if(a=e(t.currentTarget),n=a.val(),8===t.which&&(null==a.prop("selectionStart")||a.prop("selectionStart")===n.length))return/\d\s$/.test(n)?(t.preventDefault(),setTimeout(function(){return a.val(n.replace(/\d\s$/,""))})):/\s\d?$/.test(n)?(t.preventDefault(),setTimeout(function(){return a.val(n.replace(/\d$/,""))})):void 0},v=function(t){var a;return a=e(t.currentTarget),setTimeout(function(){var t;return t=a.val(),t=y(t),t=e.payment.formatExpiry(t),b(t,a)})},d=function(t){var a,n,r;if(n=String.fromCharCode(t.which),/^\d+$/.test(n))return a=e(t.currentTarget),r=a.val()+n,/^\d$/.test(r)&&"0"!==r&&"1"!==r?(t.preventDefault(),setTimeout(function(){return a.val("0"+r+" / ")})):/^\d\d$/.test(r)?(t.preventDefault(),setTimeout(function(){var e,t;return e=parseInt(r[0],10),(t=parseInt(r[1],10))>2&&0!==e?a.val("0"+e+" / "+t):a.val(r+" / ")})):void 0},l=function(t){var a,n,r;if(n=String.fromCharCode(t.which),/^\d+$/.test(n))return r=(a=e(t.currentTarget)).val(),/^\d\d$/.test(r)?a.val(r+" / "):void 0},c=function(t){var a,n,r;if("/"===(r=String.fromCharCode(t.which))||" "===r)return n=(a=e(t.currentTarget)).val(),/^\d$/.test(n)&&"0"!==n?a.val("0"+n+" / "):void 0},o=function(t){var a,n;if(a=e(t.currentTarget),n=a.val(),8===t.which&&(null==a.prop("selectionStart")||a.prop("selectionStart")===n.length))return/\d\s\/\s$/.test(n)?(t.preventDefault(),setTimeout(function(){return a.val(n.replace(/\d\s\/\s$/,""))})):void 0},m=function(t){var a;return a=e(t.currentTarget),setTimeout(function(){var e;return e=a.val(),e=(e=y(e)).replace(/\D/g,"").slice(0,4),b(e,a)})},w=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))))},$=function(a){var n,r,s,o;if(n=e(a.currentTarget),s=String.fromCharCode(a.which),/^\d+$/.test(s)&&!p(n))return o=(n.val()+s).replace(/\D/g,""),(r=t(o))?o.length<=r.length[r.length.length-1]:o.length<=16},C=function(t){var a,n;if(a=e(t.currentTarget),n=String.fromCharCode(t.which),/^\d+$/.test(n)&&!p(a))return!((a.val()+n).replace(/\D/g,"").length>6)&&void 0},g=function(t){var a,n;if(a=e(t.currentTarget),n=String.fromCharCode(t.which),/^\d+$/.test(n)&&!p(a))return(a.val()+n).length<=4},T=function(t){var a,r,s,o,i;if(i=(a=e(t.currentTarget)).val(),o=e.payment.cardType(i)||"unknown",!a.hasClass(o))return r=function(){var e,t,a;for(a=[],e=0,t=n.length;e<t;e++)s=n[e],a.push(s.type);return a}(),a.removeClass("unknown"),a.removeClass(r.join(" ")),a.addClass(o),a.toggleClass("identified","unknown"!==o),a.trigger("payment.cardType",o)},e.payment.fn.formatCardCVC=function(){return this.on("keypress",w),this.on("keypress",g),this.on("paste",m),this.on("change",m),this.on("input",m),this},e.payment.fn.formatCardExpiry=function(){return this.on("keypress",w),this.on("keypress",C),this.on("keypress",d),this.on("keypress",c),this.on("keypress",l),this.on("keydown",o),this.on("change",v),this.on("input",v),this},e.payment.fn.formatCardNumber=function(){return this.on("keypress",w),this.on("keypress",$),this.on("keypress",i),this.on("keydown",s),this.on("keyup",T),this.on("paste",h),this.on("change",h),this.on("input",h),this.on("input",T),this},e.payment.fn.restrictNumeric=function(){return this.on("keypress",w),this.on("paste",f),this.on("change",f),this.on("input",f),this},e.payment.fn.cardExpiryVal=function(){return e.payment.cardExpiryVal(e(this).val())},e.payment.cardExpiryVal=function(e){var t,a,n;return t=(n=(e=e.replace(/\s/g,"")).split("/",2))[0],2===(null!=(a=n[1])?a.length:void 0)&&/^\d+$/.test(a)&&(a=(new Date).getFullYear().toString().slice(0,2)+a),{month:t=parseInt(t,10),year:a=parseInt(a,10)}},e.payment.validateCardNumber=function(e){var a,n;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(!!(a=t(e))&&(n=e.length,S.call(a.length,n)>=0&&(!1===a.luhn||u(e))))},e.payment.validateCardExpiry=function(t,a){var n,r,s;return"object"==typeof t&&"month"in t&&(t=(s=t).month,a=s.year),!(!t||!a)&&(t=e.trim(t),a=e.trim(a),!!/^\d+$/.test(t)&&(!!/^\d+$/.test(a)&&(1<=t&&t<=12&&(2===a.length&&(a=a<70?"20"+a:"19"+a),4===a.length&&(r=new Date(a,t),n=new Date,r.setMonth(r.getMonth()-1),r.setMonth(r.getMonth()+1,1),r>n)))))},e.payment.validateCardCVC=function(t,n){var r,s;return t=e.trim(t),!!/^(?!0+$)\d+$/.test(t)&&(null!=(r=a(n))?(s=t.length,S.call(r.cvcLength,s)>=0):t.length>=3&&t.length<=4)},e.payment.cardType=function(e){var a;return e&&(null!=(a=t(e))?a.type:void 0)||null},e.payment.formatCardNumber=function(a){var n,r,s,o;return a=a.replace(/\D/g,""),(n=t(a))?(s=n.length[n.length.length-1],a=a.slice(0,s),n.format.global?null!=(o=a.match(n.format))?o.join(" "):void 0:null!=(r=n.format.exec(a))?(r.shift(),(r=e.grep(r,function(e){return e})).join(" ")):void 0):a},e.payment.formatExpiry=function(e){var t,a,n,r;return(a=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=a[1]||"",n=a[2]||"",(r=a[3]||"").length>0?n=" / ":" /"===n?(t=t.substring(0,1),n=""):2===t.length||n.length>0?n=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,n=" / "),t+n+r):""},e.payment.luhnCheck=function(e){return u(e)}}).call(this),$(function(){$('input[data-wpy="ccNum"]').payment("formatCardNumber"),$('input[data-wpy="ccExp"]').payment("formatCardExpiry"),$('input[data-wpy="ccCVC"]').payment("formatCardCVC"),$('input[data-wpy="ccCVG"]').payment("formatCardCVC"),$(".form-control").on("focus blur",function(e){$(this).parents(".form-group").toggleClass("focused","focus"===e.type||this.value.length>0)}).trigger("blur"),$("input[name=stDcc]:radio").on("change",function(){1==$("input[name=stDcc]:checked").val()?($("#btnPagoCon").removeClass("hidden"),$("#btnPagoSin").addClass("hidden")):($("#btnPagoSin").removeClass("hidden"),$("#btnPagoCon").addClass("hidden"))}),$('input[data-wpy="ccExp"]').on("blur",function(e){$("#frmWpyPayment").bootstrapValidator("revalidateField",$("#cardexp"))}),$('input[data-wpy="ccNum"]').on("change blur",function(e){var t=$('input[data-wpy="ccNum"]').val().replace(/\s+/g,"").substr(0,8);8==t.length&&(isValidTdc=!1,"amex"==$.payment.cardType($("#cardnum").val())&&1==stSKey?showAmex():hideAmex(),"amex"==$.payment.cardType($("#cardnum").val())?$('input[data-wpy="ccCVC"]').attr({placeholder:"4 dígitos",maxlength:"4"}):$('input[data-wpy="ccCVC"]').attr({placeholder:"3 dígitos",maxlength:"3"}),consultaDataPayment(t))}),$("#btnPagoSin").attr("disabled",!1),$("#btnPagoCon").attr("disabled",!1);try{void 0!==$("#nth").val()&&$("#nth").bind("keypress",function(e){var t=new RegExp("^[a-zA-ZÀ-ÿ ]+$"),a=String.fromCharCode(e.charCode?e.charCode:e.which);if(!t.test(a))return e.preventDefault(),!1})}catch(e){}$("#frmWpyPayment").formValidation({framework:"bootstrap",verbose:!0,live:"disabled",icon:{valid:"fa fa-check",invalid:"fa fa-times",validating:"fa fa-refresh"},fields:{optionsRadios:{err:"#messages",icon:"false",selector:'[data-wpy="optionsRadios"]',row:".fv-fix",validators:{notEmpty:{message:"Por favor elige una"}}},nth:{selector:'[data-wpy="nth"]',row:".fv-fix",threshold:10,validators:{notEmpty:{message:mssNameNotEmpty}}},tel:{selector:'[data-wpy="tel"]',row:".fv-fix",threshold:10,validators:{notEmpty:{message:mssTelNotEmpty},phone:{country:"US",message:mssTelTel}}},cardnum:{row:".fv-fix",threshold:12,validators:{notEmpty:{message:mssCCNotEmpty},callback:{message:mssCCNotValid,callback:function(e,t,a){$('[data-fv-for="merchant"]').css("display","none"),num=e.replace(/\D/g,"");var n=/^([2-6][0-9]{14,15})$/.test(num);return(isValidTdc||!vTdcPrevSubmit)&&$.payment.luhnCheck(num)&&n}},callback:{message:"Intente con otra tarjeta",callback:function(e,t,a){return $('[data-fv-for="merchant"]').css("display","none"),!!isValidTdc&&("0"!=$("#vigTCC").val()&&(""==$("#vigTCC").val()||(parseInt($("#vigTCC").val())>0||void 0)))}}}},cardexp:{row:".col-xs-6",threshold:3,validators:{notEmpty:{message:mssExpNotEmpty},callback:{callback:function(e,t,a){var n=!1;if(null!=e){var r=e.split("/");n=$.payment.validateCardExpiry(r[0],r[1])}if(0==n)return n;if($("#vigTCC").val().length>0){var s=parseInt($("#cardexp").val().split("/")[0].trim()),o=parseInt($("#cardexp").val().split("/")[1].trim()),i=new Date,d=i.getMonth()+1;o==parseInt(i.getFullYear().toString().substring(2))&&d+parseInt($("#vigTCC").val())>=s&&""!=$("#cardexp").val()&&alert("Le recordamos que su tarjeta está próxima a vencer")}return n},message:mssExpNotValid}}},ccCVC:{selector:'[data-wpy="ccCVC"]',row:".col-xs-6",threshold:3,validators:{notEmpty:{message:mssCvcNotEmpty},callback:{message:mssCvcNotValid,callback:function(e,t){var a=e,n=$.payment.cardType($("#cardnum").val());return $.payment.validateCardCVC(a,n)}}}},ccCVG:{selector:'[data-wpy="ccCVG"]',icon:!1,threshold:3,row:".col-xs-3",validators:{callback:{message:mssCvcNotValid,callback:function(e,t){var a=e,n=$("input:checked").val(),r=strDatos.datos,s="";$("#ccCVC"+n).val();for(var o in r)r[o].orden==n&&(s=r[o].marca);return $.payment.validateCardCVC(a,s)}}}},merchant:{selector:'[data-wpy="merchant"]',threshold:10,icon:!1,row:".fv-fix",validators:{callback:{message:mmsFailMeses,callback:function(e,t,a){return"0"!=e||($('[data-fv-for="merchant"]').css("display","inline"),!1)}}}},email:{selector:'[data-wpy="email"]',row:".fv-fix",threshold:10,validators:{notEmpty:{message:mssEmailNotEmpty},emailAddress:{message:mssEmailEmailAddress}}},stDcc:{row:".docofix",validators:{notEmpty:{message:mssDccNotEmpty}}},condiciones:{selector:'[data-wpy="condiciones"]',row:".fv-fix",threshold:10,validators:{callback:{message:mssTermsNotSelected,callback:function(e,t){return $("#condiciones").prop("checked")}}}},name:{selector:'[data-wpy="name"]',row:".fv-fix",threshold:10,validators:{notEmpty:{message:mssNameNotEmpty}}},ap:{selector:'[data-wpy="ap"]',row:".fv-fix",threshold:10,validators:{notEmpty:{message:mssAPNotEmpty}}},am:{selector:'[data-wpy="am"]',row:".fv-fix",threshold:10,validators:{notEmpty:{message:mssAMNotEmpty}}}}}).on("success.form.fv",function(e){try{$("#btnPagoCon").button("loading"),$("#btnPagoSin").button("loading");var t,a="other",n=$('input[data-wpy="email"]').val(),r=$('input[data-wpy="tel"]').val(),s=$("#merchant").val(),o=$("input[name=stDcc]:checked").val(),i=$("#nth").val();try{if(void 0!==i&&i.length>0){(l=new RSAKey).setPublic(mod,pub);var d=l.encrypt(i);i=hex2b64(d)}else i=""}catch(e){i=""}if(stAd&&(a=$("input:checked").val()),void 0!==n&&n.length>0){var l;(l=new RSAKey).setPublic(mod,pub);var c=l.encrypt(n);t=hex2b64(c)}else t="";if("other"!=a&&tienetarjetasalmacenadas){var p=strDatos.datos,u="",m="";g=new RSAKey,w="";for(var h in"1"==wppGCVV&&($("#ccCVC"+a).val(),m=$("#ccCVC"+a).val(),console.log(m),g.setPublic(mod,pub),w=g.encrypt(m),m=hex2b64(w)),p)p[h].orden!=a&&"cr"+p[h].orden!=a||(u=p[h].idClientePago);D=stAd&&$('input[data-wpy="enrolCR"]').is(":checked")?"1":"0";var v=$('input[stcr="stcr"]').is(":checked")?"1":"0";p={correo:t,tel:r,merchant:s,sessionId:ppcSid,urlValor:idUrl,stDcc:o,cardSelected:u,cpSelected:m,stSaveRol:D,stSaveCR:v,sessionIdST:"undefined"==typeof sessionIDS?"null":sessionIDS,nth:i,wppGCVV:wppGCVV,nEventId:nEventId,servertoken:servertoken}}else{var f=$("#cardexp").val().match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/);month=f[1]||"",year=f[3]||"",year.length>2&&(year=year.toString().substr(year.length-2,2));var y,g,C,w,b=$('input[data-wpy="ccCVC"]').val(),T=void 0!==$("#name").val()?$("#name").val():"",x=void 0!==$("#ap").val()?$("#ap").val():"",S=void 0!==$("#am").val()?$("#am").val():"";(g=new RSAKey).setPublic(mod,pub),"0"==servertoken?(C=$("#cardnum").val().replace(/\s+/g,""),w=g.encrypt(C+","+month+","+year+","+b),y=hex2b64(w)):(w=g.encrypt(servertoken+","+month+","+year+","+b),y=hex2b64(w));var k=stAd&&$('input[data-wpy="rememberMe"]').is(":checked")?"1":"0",D=stAd&&$('input[data-wpy="enrolCR"]').is(":checked")?"1":"0";""!=disabledEmail&&(n=originalEmail),$('input[stcr="stcr"]').is(":checked")&&(k="0",D="0"),p={correo:t,name:T,ap:x,am:S,tel:r,merchant:s,sessionId:ppcSid,urlValor:idUrl,stDcc:o,numenc:y,stSave:k,stSaveRol:D,sessionIdST:"undefined"==typeof sessionIDS?"null":sessionIDS,nth:i,nEventId:nEventId,servertoken:servertoken}}$("#vhidden").val(encodeURIComponent(JSON.stringify(p))),$("#cardnum").attr("disabled",!0),$("#cardexp").attr("disabled",!0),$('input[data-wpy="ccCVC"]').attr("disabled",!0),$('input[data-wpy="ccCVG"]').attr("disabled",!0),$('input[data-wpy="email"]').attr("disabled",!0)}catch(e){return $("#btnPagoSin").attr("disabled",!1),$("#btnPagoCon").attr("disabled",!1),$("#cardnum").attr("disabled",!1),$("#cardexp").attr("disabled",!1),$('input[data-wpy="ccCVC"]').attr("disabled",!1),$('input[data-wpy="ccCVG"]').attr("disabled",!1),$('input[data-wpy="email"]').attr("disabled",!1),$("#btnPagoCon").button("reset"),$("#btnPagoSin").button("reset"),document.getElementById("frmdiv").style.display="none",document.getElementById("ftdiv").style.display="none",document.getElementById("errdiv").style.display="block",!1}})}),$(function(){tienetarjetasalmacenadas?($("#divTdcForm").hide(),$("#divTknForm").show(),$("#rowGuardar").addClass("hidden")):$("#divTknForm").hide(),$("[data-toggle=confirmation]").confirmation({rootSelector:"[data-toggle=confirmation]",container:"body"}),$("#helpRememberMe").popover({container:"body",content:txtSaveCardHelp,delay:{show:100,hide:100},placement:"auto top",title:txtSaveCardTitle,trigger:"click"}),$("input[data-wpy='enrolCR']").change(function(){$(this).is(":checked")?$("#rowGuardar").addClass("hidden"):1==$('input[data-wpy="optionsRadios"]').is(":checked")&&0==$('input[value="other"]').is(":checked")?$("#rowGuardar").addClass("hidden"):$("#rowGuardar").removeClass("hidden")}),$("input[name='optionsRadios']").change(function(){$("#rememberMe").removeAttr("disabled");try{void 0!==$("#nth").val()&&$("#nth").val("")}catch(e){}var e=$(this).val();if(null!=$(this).attr("stcr")?($("#rowGuardar").addClass("hidden"),$("#rowGuardarCR").addClass("hidden")):($("#rowGuardar").removeClass("hidden"),$("#rowGuardarCR").removeClass("hidden")),$("input[stcr]").val()==$("input:checked").val().substring(2)?($("#rowGuardar").addClass("hidden"),$("#rowGuardarCR").addClass("hidden")):null==$(this).attr("stcr")&&$("#rowGuardarCR").removeClass("hidden"),$(".ccRow").removeClass("ccRowActive"),$(this).closest(".ccRow").addClass("ccRowActive"),"other"==e)$("#divTdcForm").slideDown("slow"),$("#rowGuardarCR").removeClass("hidden"),$("#cardnum").focus(),stTd<nuAm?$("#rowGuardar").removeClass("hidden"):$("#rowGuardar").addClass("hidden");else{$("#divTdcForm").slideUp("slow"),$("#ccCVC"+e).focus(),$("#rowGuardar").addClass("hidden");var t=strDatos.datos,a="",n="";for(var r in t)t[r].orden!=e&&"cr"+t[r].orden!=e||(a=t[r].bin,n=t[r].marca);"amex"==n&&1==stSKey?showAmex():hideAmex(),consultaDataPayment(a)}"1"==wppnoEnviar&&"other"!=e&&$("#st3ds").addClass("hidden"),"1"==wppnoEnviar&&"other"==e&&$("#st3ds").removeClass("hidden")}),$(".ccDelete").on("click",function(e){e.preventDefault(),$(this).closest(".ccRow").hide("slow").remove(),stTd-=1;e.target.id;var t=strDatos.datos,a="";for(var n in t)"rd_"+t[n].orden==e.target.id&&(a=t[n].idClientePago);var r={async:!0,crossDomain:!0,url:opcionesPagoUrl.replace("merchants","deleteClient"),method:"POST",dataType:"json",processData:!1,contentType:"application/json",data:'{"idClientePago":"'+a+'","iRef":"'+idUrl+'"}'};$.ajax(r).done(function(e){0==stTd&&($("input[name='optionsRadios'][value='other']").attr("checked",!0),$("#divTknForm").hide(),$("#divTdcForm").show(),$("#cardnum").focus()),stTd<nuAm&&$("#rowGuardar").removeClass("hidden")})});var e=0;$('input:radio[id="optionsRadios"]').each(function(){$(this).attr("disabled",!1),e++}),0==e&&$("#rememberMe").removeAttr("disabled"),$("#idArrayTdcSave").val()>0&&$('input:radio[id="optionsRadios"]').each(function(){for(var e=$("#idArrayTdcSave").val(),t=$(this).val();0<e;e--)if($(":hidden[name*='"+e+"']").val()===t){$(this).attr("disabled",!0);break}})});